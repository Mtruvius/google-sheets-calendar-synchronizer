<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
  </head>
  <style>
    body {
      font-family: 'Poppins';
    }
    #dateRangeSubmitBtn {
      position: relative;
      float: right;
      padding: 7px;
      background: lightskyblue;
      border: 0;
      border-radius: 5px;
      color: #000000;
      box-shadow: 1px 1px 2px #00000091;
      margin-top: 18px;
      cursor: pointer;
    }
    #dateRangeSubmitBtn:hover {
      background: skyblue;
    }
  </style>
  <body>
    <form id="dateRange">
      <label for="start">From:</label>
      <input type="date" id="start" name="start" />
      <label for="end">To:</label>
      <input type="date" id="end" name="end" />
    </form>
    <button id="dateRangeSubmitBtn" title="Submit" onclick="getData()">Submit</button>
  </body>
  <script>
    var startInput = document.getElementById('start');
    var endInput = document.getElementById('end');
    var minYear = new Date().getFullYear() - 1 + '-01-01';
    var maxYear = new Date().getFullYear() + 3 + '-12-31';
    var today = new Date();
    var tomorrow = new Date(today);
    tomorrow.setDate(today.getDate() + 1);

    async function getData() {
      var form = document.getElementById('dateRange');
      const formData = new FormData(form);
      const dataObject = Object.fromEntries(formData.entries());
      await google.script.run.withSuccessHandler(closeDialog).importCalendarEventsToSheet(dataObject);
    }

    function closeDialog() {
      google.script.host.close();
    }

    startInput.value = today.toISOString().split('T')[0];
    startInput.min = minYear;
    startInput.max = maxYear;
    endInput.value = tomorrow.toISOString().split('T')[0];
    endInput.min = minYear;
    endInput.max = maxYear;
  </script>
</html>
